todo: Add validation to the return types ans sizes in functions
todo: maybe refactor the interface
todo: calculate the value of the Jacobian